<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Worms.io (AI Only)</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #141428;
      font-family: Arial, sans-serif;
    }
    #gameCanvas {
      display: block;
      background: #141428;
    }
    #overlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-size: 20px;
      text-shadow: 0 0 4px black;
      pointer-events: none;
    }
    #leaderboard {
      position: absolute;
      top: 10px;
      right: 10px;
      color: white;
      font-size: 14px;
      text-shadow: 0 0 4px black;
      pointer-events: none;
    }
    #boostHint {
      position: absolute;
      bottom: 10px;
      left: 10px;
      color: #aaaaaa;
      font-size: 14px;
      text-shadow: 0 0 4px black;
      pointer-events: none;
    }
    #menu {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #303548, #141428);
    }
    #menuInner {
      background: rgba(0,0,0,0.6);
      padding: 30px 40px;
      border-radius: 16px;
      text-align: center;
      color: white;
      box-shadow: 0 0 20px rgba(0,0,0,0.8);
    }
    #menuTitle {
      font-size: 64px;
      margin-bottom: 10px;
    }
    #menuSubtitle {
      font-size: 18px;
      margin-bottom: 20px;
      color: #a0a8c0;
    }
    #nicknameInput {
      width: 240px;
      padding: 10px 14px;
      border-radius: 23px;
      border: 2px solid #64609a;
      background: #2b2840;
      color: white;
      font-size: 16px;
      outline: none;
      margin-bottom: 20px;
    }
    #playAIButton {
      padding: 10px 20px;
      border-radius: 25px;
      border: none;
      background: #3aa86a;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s;
      margin: 0 5px;
    }
    #playAIButton:disabled {
      background: #2b5f40;
      cursor: default;
    }
    #playAIButton:not(:disabled):hover {
      background: #45c47b;
      transform: translateY(-1px);
    }
    #deathOverlay {
      position: absolute;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.5);
      color: white;
      text-align: center;
      pointer-events: none;
    }
    #deathInner {
      pointer-events: auto;
      background: rgba(0,0,0,0.7);
      padding: 20px 30px;
      border-radius: 12px;
    }
    #deathInner h1 {
      margin: 0 0 10px 0;
      color: #ff6464;
    }
    #deathInner p {
      margin: 4px 0;
    }
    #deathHint {
      margin-top: 10px;
      font-size: 14px;
      color: #dddddd;
    }
    #minimap {
      position: absolute;
      bottom: 10px;
      right: 10px;
      width: 160px;
      height: 160px;
      background: rgba(0,0,0,0.5);
      border-radius: 8px;
      border: 1px solid #444;
      pointer-events: none;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="overlay">
  <div id="ui"></div>
  <div id="leaderboard"></div>
  <div id="boostHint">HOLD SPACE/CLICK TO BOOST</div>
  <canvas id="minimap"></canvas>
</div>

<div id="menuInner">
  <div id="menuTitle">
    <span style="color:#64ff96;text-shadow:3px 3px 0 #28643a;">worms</span>
    <span style="color:#a064ff;text-shadow:3px 3px 0 #3a2864;">.io</span>
  </div>
  <div id="menuSubtitle">Eat food. Grow. Don't die.</div>
  <input id="nicknameInput" placeholder="Nickname" maxlength="15" />
  <div style="margin-top:12px;">
    <button id="playAIButton" disabled>Play</button>
  </div>
</div>
</div>

<div id="deathOverlay">
  <div id="deathInner">
    <h1>YOU DIED!</h1>
    <p id="finalScoreText">Final Score: 0</p>
    <p id="killedByText"></p>
    <p id="deathHint">Press R to Restart or ESC to Menu</p>
  </div>
</div>

<script>
(() => {
  const MAP_SIZE = 4000;

  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const uiDiv = document.getElementById("ui");
  const leaderboardDiv = document.getElementById("leaderboard");
  const menuDiv = document.getElementById("menu");
  const nicknameInput = document.getElementById("nicknameInput");
  const playAIButton = document.getElementById("playAIButton");
  const deathOverlay = document.getElementById("deathOverlay");
  const finalScoreText = document.getElementById("finalScoreText");
  const killedByText = document.getElementById("killedByText");
  const minimap = document.getElementById("minimap");
  const minimapCtx = minimap.getContext("2d");

  let SCREEN_WIDTH = window.innerWidth;
  let SCREEN_HEIGHT = window.innerHeight;
  canvas.width = SCREEN_WIDTH;
  canvas.height = SCREEN_HEIGHT;

  minimap.width = 160;
  minimap.height = 160;

  let mouseX = SCREEN_WIDTH / 2;
  let mouseY = SCREEN_HEIGHT / 2;
  let keys = {};
  let mouseDown = false;

  let gameState = "menu";
  let playerName = "";
  let camera = { x: 0, y: 0 };

  let player = null;
  let aiSnakes = [];
  let foodList = [];
  let allSnakes = [];
  let killedBy = null;

  const BG_COLOR = "#141428";
  const GRID_COLOR = "#1e1e32";
  const FOOD_COLORS = [
    "#ff6464", "#64ff64", "#6464ff",
    "#ffff64", "#ff64ff", "#64ffff"
  ];
  const AI_NAMES = [
    "ProGamer","SnakeKing","Viper","SlitherMaster","NoobSlayer",
    "FastBoi","BigSnake","Hunter","Predator","Shadow",
    "Lightning","Dragon","Python","Cobra","Anaconda"
  ];

  window.addEventListener("resize", () => {
    SCREEN_WIDTH = window.innerWidth;
    SCREEN_HEIGHT = window.innerHeight;
    canvas.width = SCREEN_WIDTH;
    canvas.height = SCREEN_HEIGHT;
  });

  window.addEventListener("mousemove", e => {
    mouseX = e.clientX;
    mouseY = e.clientY;
  });
  window.addEventListener("mousedown", () => { mouseDown = true; });
  window.addEventListener("mouseup", () => { mouseDown = false; });
  window.addEventListener("keydown", e => {
    keys[e.code] = true;
    if (e.code === "KeyR" && gameState === "dead") restartGame();
    if (e.code === "Escape" && gameState === "dead") {
      gameState = "menu";
      deathOverlay.style.display = "none";
      menuDiv.style.display = "flex";
    }
  });
  window.addEventListener("keyup", e => {
    keys[e.code] = false;
  });

  nicknameInput.addEventListener("input", () => {
    playAIButton.disabled = nicknameInput.value.trim().length === 0;
  });

  playAIButton.addEventListener("click", () => {
    playerName = nicknameInput.value.trim();
    startGameVsAI();
  });
      }
    }
  };

  function Food() {
    this.x = Math.random() * MAP_SIZE;
    this.y = Math.random() * MAP_SIZE;
    this.color = FOOD_COLORS[Math.floor(Math.random() * FOOD_COLORS.length)];
    this.radius = 4 + Math.floor(Math.random() * 4);
  }

  Food.prototype.render = function(camera) {
    const x = this.x - camera.x;
    const y = this.y - camera.y;
    if (x < -20 || x > canvas.width + 20 || y < -20 || y > canvas.height + 20) return;

    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(x, y, this.radius, 0, Math.PI * 2);
    ctx.fill();
  };

  function drawGrid(camera) {
    const gridSize = 80;
    const startX = -(camera.x % gridSize);
    const startY = -(camera.y % gridSize);

    ctx.strokeStyle = GRID_COLOR;
    ctx.lineWidth = 1;
    ctx.beginPath();

    for (let x = startX; x < canvas.width; x += gridSize) {
      ctx.moveTo(x, 0);
      ctx.lineTo(x, canvas.height);
    }
    for (let y = startY; y < canvas.height; y += gridSize) {
      ctx.moveTo(0, y);
      ctx.lineTo(canvas.width, y);
    }

    ctx.stroke();
  }

  function drawLeaderboard(snakes) {
    const alive = snakes.filter(s => s.alive);
    alive.sort((a, b) => b.getScore() - a.getScore());
    const top = alive.slice(0, 10);

    let html = '<div style="font-weight:bold;color:#ffff64;margin-bottom:4px;">Leaderboard</div>';
    for (let i = 0; i < top.length; i++) {
      const s = top[i];
      let color = "#ffffff";
      if (i === 0) color = "#ffd700";
      else if (i === 1) color = "#c0c0c0";
      else if (i === 2) color = "#cd7f32";

      html += `<div style="color:${color};">${i+1}. ${s.name.substring(0,10)} <span style="float:right;">${s.getScore()}</span></div>`;
    }

    leaderboardDiv.innerHTML = html;
  }

  function drawMinimap() {
    minimapCtx.clearRect(0, 0, minimap.width, minimap.height);
    minimapCtx.fillStyle = "rgba(0,0,0,0.6)";
    minimapCtx.fillRect(0, 0, minimap.width, minimap.height);

    const scaleX = minimap.width / MAP_SIZE;
    const scaleY = minimap.height / MAP_SIZE;

    minimapCtx.strokeStyle = "#666";
    minimapCtx.strokeRect(0, 0, minimap.width, minimap.height);

    minimapCtx.fillStyle = "#64ff64";
    for (const s of allSnakes) {
      if (!s.alive) continue;
      const head = s.segments[0];
      const x = head[0] * scaleX;
      const y = head[1] * scaleY;

      minimapCtx.beginPath();
      minimapCtx.arc(x, y, s === player ? 4 : 3, 0, Math.PI * 2);
      minimapCtx.fill();
    }
  }

  function startGameVsAI() {
    menuDiv.style.display = "none";
    deathOverlay.style.display = "none";
    gameState = "playing";

    const startX = Math.random() * MAP_SIZE;
    const startY = Math.random() * MAP_SIZE;

    player = new Snake(startX, startY, playerName, true);

    aiSnakes = [];
    for (let i = 0; i < 15; i++) {
      const x = Math.random() * MAP_SIZE;
      const y = Math.random() * MAP_SIZE;
      const name = AI_NAMES[Math.floor(Math.random() * AI_NAMES.length)];
      aiSnakes.push(new Snake(x, y, name, false));
    }

    foodList = [];
    for (let i = 0; i < 400; i++) {
      foodList.push(new Food());
    }

    allSnakes = [player, ...aiSnakes];
    killedBy = null;

    camera.x = player.segments[0][0] - canvas.width / 2;
    camera.y = player.segments[0][1] - canvas.height / 2;
  }

  function restartGame() {
    startGameVsAI();
  }

  function update() {
    if (gameState !== "playing") return;

    const boosting = keys["Space"] || mouseDown;

    if (player && player.alive) {
      player.updatePlayer(camera, boosting);
      camera.x = player.segments[0][0] - canvas.width / 2;
      camera.y = player.segments[0][1] - canvas.height / 2;
    }

    for (const ai of aiSnakes) {
      ai.updateAI(foodList, allSnakes);
    }

    for (const snake of allSnakes) {
      const killer = snake.checkCollision(allSnakes);
      if (killer && !snake.alive) {
        const pellets = snake.createFoodFromBody();
        foodList.push(...pellets);

        if (snake === player) killedBy = killer.name;
      }
    }

    for (const snake of allSnakes) {
      if (!snake.alive) continue;
      const head = snake.segments[0];

      for (let i = foodList.length - 1; i >= 0; i--) {
        const f = foodList[i];
        const dx = head[0] - f.x;
        const dy = head[1] - f.y;
        const dist = Math.sqrt(dx * dx + dy * dy);

        if (dist < 15) {
          snake.targetLength += 1;
          foodList.splice(i, 1);
          foodList.push(new Food());
        }
      }
    }

    for (let i = 0; i < aiSnakes.length; i++) {
      if (!aiSnakes[i].alive) {
        const x = Math.random() * MAP_SIZE;
        const y = Math.random() * MAP_SIZE;
        const name = AI_NAMES[Math.floor(Math.random() * AI_NAMES.length)];
        aiSnakes[i] = new Snake(x, y, name, false);
      }
    }

    allSnakes = [player, ...aiSnakes];

    if (player && !player.alive && gameState === "playing") {
      gameState = "dead";
      deathOverlay.style.display = "flex";
      finalScoreText.textContent = "Final Score: " + player.getScore();
      killedByText.textContent = killedBy ? "Killed by: " + killedBy : "";
    }
  }

  function render() {
    ctx.fillStyle = BG_COLOR;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    if (gameState === "menu") {
      uiDiv.textContent = "";
      leaderboardDiv.innerHTML = "";
      drawMinimap();
      return;
    }

    drawGrid(camera);

    for (const f of foodList) f.render(camera);
    for (const s of allSnakes) s.render(camera);

    if (player) uiDiv.textContent = "Score: " + player.getScore();
    drawLeaderboard(allSnakes);
    drawMinimap();
  }

  function loop() {
    update();
    render();
    requestAnimationFrame(loop);
  }

  loop();
})();
</script>
</body>
</html>




